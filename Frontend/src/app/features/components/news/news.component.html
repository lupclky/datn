<section class="news-page">
  <!-- Header with Background -->
  <div class="news-hero">
    <div class="hero-overlay"></div>
    <div class="container">
      <div class="hero-content">
        <h1 class="hero-title">Tin Tức & Sự Kiện</h1>
        <p class="hero-subtitle">Cập nhật thông tin mới nhất về sản phẩm và công nghệ</p>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="news-content">
    <div class="container">
      <!-- Search & Filter Section -->
      <div class="search-filter-section">
        <div class="row align-items-center">
          <div class="col-lg-8 col-md-7 mb-3 mb-md-0">
            <div class="search-box">
              <i class="pi pi-search search-icon"></i>
              <input 
                type="text" 
                class="form-control search-input" 
                [(ngModel)]="searchQuery"
                (input)="onSearch()"
                placeholder="Tìm kiếm tin tức, sự kiện...">
            </div>
          </div>
          <div class="col-lg-4 col-md-5 text-md-end">
            <div class="total-news">
              <i class="pi pi-list"></i>
              <span>{{ totalRecords }} bài viết</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Loading State -->
      <div class="loading-state" *ngIf="isLoading">
        <div class="spinner-wrapper">
          <div class="spinner-border text-danger" role="status"></div>
          <p class="mt-3">Đang tải tin tức...</p>
        </div>
      </div>

      <!-- News Grid -->
      <div class="news-grid" *ngIf="!isLoading && newsList.length > 0">
        <div class="row g-4">
          <div class="col-lg-4 col-md-6" *ngFor="let news of newsList">
            <div class="news-card" (click)="openNewsDetail(news)">
              <div class="news-card-image">
                <img 
                  [src]="news.thumbnail || 'assets/images/post1.jpg'" 
                  [alt]="news.title"
                  loading="lazy">
                <div class="news-badge">
                  <span class="badge-text">{{ formatDate(news.createdAt) }}</span>
                </div>
                <div class="news-overlay">
                  <i class="pi pi-eye"></i>
                  <span>Xem chi tiết</span>
                </div>
              </div>
              <div class="news-card-body">
                <h3 class="news-title">{{ news.title }}</h3>
                <p class="news-excerpt">{{ getExcerpt(news.content) }}</p>
                <div class="news-footer">
                  <div class="news-meta">
                    <i class="pi pi-user"></i>
                    <span>Admin</span>
                  </div>
                  <div class="news-status">
                    <span class="status-badge" [class.active]="news.status === 'ACTIVE'">
                      {{ news.status }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div class="empty-state" *ngIf="!isLoading && newsList.length === 0">
        <div class="empty-icon">
          <i class="pi pi-inbox"></i>
        </div>
        <h3>Không tìm thấy tin tức</h3>
        <p>Thử tìm kiếm với từ khóa khác hoặc quay lại sau</p>
      </div>

      <!-- Pagination -->
      <div class="pagination-wrapper" *ngIf="!isLoading && totalRecords > pageSize">
        <p-paginator 
          [rows]="pageSize" 
          [totalRecords]="totalRecords" 
          [first]="currentPage * pageSize"
          (onPageChange)="onPageChange($event)" 
          [rowsPerPageOptions]="[6, 9, 12]">
        </p-paginator>
      </div>
    </div>
  </div>
</section>

<!-- News Detail Modal -->
<p-dialog 
  [(visible)]="showDetailModal" 
  [modal]="true" 
  [closable]="true"
  [dismissableMask]="true"
  [style]="{width: '90vw', maxWidth: '950px'}"
  [contentStyle]="{padding: '0', overflow: 'auto', maxHeight: '80vh'}"
  styleClass="news-detail-modal">
  
  <ng-template pTemplate="header">
    <div class="modal-header-content">
      <i class="pi pi-book header-icon"></i>
      <h2 class="modal-title">{{ selectedNews?.title }}</h2>
    </div>
  </ng-template>

  <div class="modal-content-wrapper" *ngIf="selectedNews">
    <!-- Featured Image (Always show with fallback) -->
    <div class="modal-featured-image">
      <img 
        [src]="selectedNews.thumbnail || 'assets/images/post1.jpg'" 
        [alt]="selectedNews.title" 
        loading="lazy">
    </div>

    <!-- Title -->
    <div class="modal-title-content">
      <h1 class="news-detail-title">{{ selectedNews.title }}</h1>
    </div>

    <!-- Meta Info -->
    <div class="modal-meta">
      <div class="meta-item">
        <i class="pi pi-calendar"></i>
        <span>{{ formatFullDate(selectedNews.createdAt) }}</span>
      </div>
      <div class="meta-item">
        <i class="pi pi-user"></i>
        <span>Admin</span>
      </div>
      <div class="meta-item">
        <span class="status-badge" [class.active]="selectedNews.status === 'ACTIVE'">
          {{ selectedNews.status }}
        </span>
      </div>
    </div>

    <!-- Content -->
    <div class="modal-body-content">
      <div [innerHTML]="selectedNews.content || '<p>Chưa có nội dung cho bài viết này.</p>'" class="news-content-html"></div>
    </div>
  </div>

  <ng-template pTemplate="footer">
    <button type="button" class="btn btn-secondary btn-close-modal" (click)="closeModal()">
      <i class="pi pi-times"></i> Đóng
    </button>
  </ng-template>
</p-dialog>
